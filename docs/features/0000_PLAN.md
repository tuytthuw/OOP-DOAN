# Kế Hoạch Kỹ Thuật #0000 - Xây Dựng Model Person Base Class

## 1. Mô Tả Ngữ Cảnh

Tạo lớp trừu tượng `Person` làm lớp cơ sở cho tất cả những người trong hệ thống (Customer, Employee, Receptionist, Technician). Lớp này chứa các thuộc tính chung và phương thức chung cho tất cả các lớp con.

---

## 2. Các Tệp và Hàm Liên Quan

### Tệp TẠO MỚI:

- `src/main/java/models/Person.java` - Lớp abstract cơ sở

### Tệp THAY ĐỔI:

- `src/main/java/models/Init.java` - Không cần thay đổi (Person là abstract)
- `src/main/java/models/Customer.java` - Sẽ được cập nhật ở 0001

---

## 3. Thuật Toán / Logic (Từng Bước)

### 3.1 Cấu Trúc Lớp Person (Abstract)

```
Person (Abstract)
├── Thuộc tính (Attributes):
│   ├── personId: String (ID duy nhất, định dạng phụ thuộc lớp con)
│   ├── fullName: String (Họ tên đầy đủ)
│   ├── phoneNumber: String (Số điện thoại)
│   ├── email: String (Địa chỉ email)
│   ├── address: String (Địa chỉ cư trú)
│   ├── isMale: boolean (Giới tính: true=Nam, false=Nữ)
│   ├── birthDate: LocalDate (Ngày sinh)
│   └── isDeleted: boolean (Trạng thái xóa logic)
│
├── Phương Thức (Methods):
│   ├── Constructor(personId, fullName, phoneNumber, email, address, isMale, birthDate)
│   ├── getId(): String (Lấy ID cá nhân)
│   ├── getAge(): int (Tính tuổi dựa trên birthDate)
│   ├── getGenderString(): String (Trả về "Nam" hoặc "Nữ")
│   ├── getPersonInfo(): String (Thông tin chi tiết cá nhân)
│   ├── updateContactInfo(phoneNumber, email, address): void (Cập nhật thông tin liên hệ)
│   ├── softDelete(): void (Đánh dấu xóa, không thực sự xóa)
│   ├── restore(): void (Khôi phục từ xóa)
│   ├── Getter/Setter cho tất cả thuộc tính
│   └── equals() & hashCode() (So sánh dựa trên personId)
```

### 3.2 Logic Tính Tuổi

**Bước thực hiện `getAge()`:**

1. Lấy ngày hiện tại: `LocalDate.now()`
2. Tính hiệu năm: `currentYear - birthDate.getYear()`
3. Kiểm tra nếu chưa tới sinh nhật năm nay:
   - Nếu `currentMonth < birthMonth` hoặc `(currentMonth == birthMonth && currentDay < birthDay)`: trừ 1 năm
4. Trả về tuổi

**Ví dụ:**

- Ngày sinh: 15/03/1990
- Ngày hiện tại: 10/03/2025
- Tuổi = 2025 - 1990 - 1 = 34 (chưa tới sinh nhật)

### 3.3 Logic Xóa Mềm (Soft Delete)

**Bước thực hiện `softDelete()`:**

1. Đặt `isDeleted = true`
2. Không thực sự xóa dữ liệu khỏi database/list

**Bước thực hiện `restore()`:**

1. Đặt `isDeleted = false`
2. Khôi phục trạng thái hoạt động

**Lợi Ích:**

- Giữ lại lịch sử dữ liệu
- Tuân thủ GDPR (không xóa vĩnh viễn)
- Dễ hồi phục dữ liệu

---

## 4. Ghi Chú Kỹ Thuật

- `Person` là **abstract class**, không thể instantiate trực tiếp
- Lớp con phải override `getId()` nếu cần định dạng ID riêng
- Sử dụng `LocalDate` từ `java.time` để quản lý ngày tháng
- Phương thức `getAge()` tính động, không lưu trong database
- `isDeleted` cho phép soft delete, không thực sự xóa dữ liệu
- Comment bằng tiếng Việt cho Javadoc và logic phức tạp

---

## 5. Mối Quan Hệ Với Các Lớp Khác

```
Person (Abstract)
├── Customer extends Person
├── Employee extends Person
│   ├── Receptionist extends Employee
│   └── Technician extends Employee
```

---

## 6. Lưu Ý Quan Trọng

- **Ưu tiên:** Kế hoạch 0000 phải được thực hiện **TRƯỚC** 0001 (Customer)
- **Tương thích:** Kế hoạch 0001 sẽ được điều chỉnh để Customer kế thừa Person
- **Tương thích:** Kế hoạch 0011 (Employee) sẽ kế thừa Person
- **Thiết kế:** Tuân thủ nguyên tắc DRY (Don't Repeat Yourself)
